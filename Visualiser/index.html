<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlaeAutomates API Explorer</title>
    <link rel="stylesheet" href="/visualizer/styles.css">
    <!-- Using system fonts for CSP compliance -->
</head>
<body>
    <div class="app">
        <!-- Single Professional Navigation -->
        <nav class="navbar">
            <div class="container">
                <div class="navbar-content">
                    <!-- Brand -->
                    <div class="navbar-brand">
                        <h1 class="brand-title">AlaeAutomates</h1>
                        <span class="brand-subtitle">API Explorer</span>
                    </div>
                    
                    <!-- Navigation Tabs -->
                    <div class="navbar-nav">
                        <button class="nav-link active" data-section="overview">
                            Overview
                        </button>
                        <button class="nav-link" data-section="credit-cards">
                            Credit Cards
                        </button>
                        <button class="nav-link" data-section="statements">
                            Statements
                        </button>
                        <button class="nav-link" data-section="invoices">
                            Invoices
                        </button>
                        <button class="nav-link" data-section="macros">
                            Macros
                        </button>
                    </div>
                    
                    <!-- Connection Controls -->
                    <div class="navbar-controls">
                        <div class="control-group">
                            <label for="baseUrl" class="control-label">URL</label>
                            <input 
                                type="url" 
                                id="baseUrl" 
                                class="control-input"
                                placeholder="localhost:5000"
                                value="localhost:5001"
                            >
                        </div>
                        <button id="testConnection" class="btn btn-primary btn-sm">
                            Test
                        </button>
                        <div id="connectionStatus" class="status-indicator status-disconnected">
                            ‚óè
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main">
            <div class="container">
                <!-- Overview Section -->
                <section id="overview" class="section active">
                    <div class="section-header">
                        <h2 class="section-title">API Overview</h2>
                        <p class="section-description">
                            Comprehensive REST API for financial document processing and automation
                        </p>
                    </div>

                    <div class="grid three-column">
                        <div class="feature-card">
                            <div class="feature-header">
                                <h3 class="feature-title">Health Check</h3>
                            </div>
                            <p class="feature-description">
                                Verify API connectivity and service status for all endpoints
                            </p>
                            <div class="feature-actions">
                                <button id="healthCheck" class="btn btn-outline">
                                    Run Health Check
                                </button>
                            </div>
                            <div id="healthResult" class="result-display"></div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-header">
                                <h3 class="feature-title">API Features</h3>
                            </div>
                            <p class="feature-description">
                                Comprehensive suite of financial document processing APIs
                            </p>
                            <div class="feature-content">
                                <ul class="feature-list">
                                    <li>Credit Card Automation</li>
                                    <li>Monthly Statement Processing</li>
                                    <li>Invoice Separation</li>
                                    <li>Excel Macro Generation</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-header">
                                <h3 class="feature-title">Documentation</h3>
                            </div>
                            <p class="feature-description">
                                Complete API documentation and usage examples
                            </p>
                            <div class="feature-actions">
                                <button class="btn btn-secondary" id="viewDocsBtn">
                                    View API Docs
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Credit Cards Section -->
                <section id="credit-cards" class="section">
                    <div class="section-header">
                        <h2 class="section-title">Credit Card Batch Automation</h2>
                        <p class="section-description">
                            Generate JavaScript automation code for payment processing with enterprise-grade reliability
                        </p>
                    </div>

                    <div class="grid three-column">
                        <!-- Parse Excel Text -->
                        <div class="api-card">
                            <div class="api-header">
                                <h3 class="api-title">Parse Excel Text</h3>
                                <div class="method-badge method-post">POST</div>
                            </div>
                            <div class="api-path">/api/v1/cc-batch/parse-excel-text</div>
                            <p class="api-description">
                                Convert Excel credit card transaction data into automated JavaScript code
                            </p>
                            
                            <div class="form-section">
                                <div class="form-group">
                                    <label for="excelTextInput" class="form-label">Excel Text Data</label>
                                    <textarea 
                                        id="excelTextInput" 
                                        class="form-textarea"
                                        placeholder="R130587 AMEX-1006 105.00 Wanyi Yang"
                                        rows="4"
                                    ></textarea>
                                </div>
                                <div class="form-actions">
                                    <button type="button" class="btn btn-secondary" id="fillSampleBtn">
                                        Fill Sample Data
                                    </button>
                                    <button class="btn btn-success" data-endpoint="parse-excel-text">
                                        Test API
                                    </button>
                                </div>
                            </div>
                            <div id="parseExcelTextResult" class="result-display"></div>
                        </div>

                        <!-- Process Excel File -->
                        <div class="api-card">
                            <div class="api-header">
                                <h3 class="api-title">Process Excel File</h3>
                                <div class="method-badge method-post">POST</div>
                            </div>
                            <div class="api-path">/api/v1/cc-batch/process</div>
                            <p class="api-description">
                                Upload Excel files containing credit card transactions for automation code generation
                            </p>
                            
                            <div class="form-section">
                                <div class="form-group">
                                    <label for="excelFileInput" class="form-label">Excel File (.xlsx, .xls)</label>
                                    <input 
                                        type="file" 
                                        id="excelFileInput" 
                                        class="form-file"
                                        accept=".xlsx,.xls"
                                    >
                                </div>
                                <div class="form-actions">
                                    <button class="btn btn-success" data-endpoint="process-excel">
                                        Upload & Process
                                    </button>
                                </div>
                            </div>
                            <div id="processExcelResult" class="result-display"></div>
                        </div>

                        <!-- Download Code -->
                        <div class="api-card">
                            <div class="api-header">
                                <h3 class="api-title">Download Generated Code</h3>
                                <div class="method-badge method-post">POST</div>
                            </div>
                            <div class="api-path">/api/v1/cc-batch/download-code</div>
                            <p class="api-description">
                                Download generated JavaScript automation code as a .js file
                            </p>
                            
                            <div class="form-section">
                                <div class="form-group">
                                    <label for="jsCodeInput" class="form-label">JavaScript Code</label>
                                    <textarea 
                                        id="jsCodeInput" 
                                        class="form-textarea"
                                        placeholder="Paste generated JavaScript code here..."
                                        rows="4"
                                    ></textarea>
                                </div>
                                <div class="form-actions">
                                    <button class="btn btn-success" data-endpoint="download-code">
                                        Download File
                                    </button>
                                </div>
                            </div>
                            <div id="downloadCodeResult" class="result-display"></div>
                        </div>
                    </div>
                </section>

                <!-- Statements Section -->
                <section id="statements" class="section">
                    <div class="section-header">
                        <h2 class="section-title">Monthly Statements Processing</h2>
                        <p class="section-description">
                            Process PDF statements with Excel company lists for intelligent transaction categorization
                        </p>
                    </div>

                    <div class="grid two-column">
                        <!-- Process Statements -->
                        <div class="api-card">
                            <div class="api-header">
                                <h3 class="api-title">Process Statements</h3>
                                <div class="method-badge method-post">POST</div>
                            </div>
                            <div class="api-path">/api/v1/monthly-statements/process</div>
                            <p class="api-description">
                                Analyze PDF statements and categorize transactions using your company list
                            </p>
                            
                            <div class="form-section">
                                <div class="form-group">
                                    <label for="pdfFileInput" class="form-label">PDF Statement</label>
                                    <input 
                                        type="file" 
                                        id="pdfFileInput" 
                                        class="form-file"
                                        accept=".pdf"
                                    >
                                </div>
                                <div class="form-group">
                                    <label for="excelStatementsInput" class="form-label">Excel Company List</label>
                                    <input 
                                        type="file" 
                                        id="excelStatementsInput" 
                                        class="form-file"
                                        accept=".xlsx,.xls"
                                    >
                                </div>
                                <div class="form-actions">
                                    <button class="btn btn-success" data-endpoint="process-statements">
                                        Process Files
                                    </button>
                                </div>
                            </div>
                            <div id="processStatementsResult" class="result-display"></div>
                        </div>

                        <!-- Check Status -->
                        <div class="api-card">
                            <div class="api-header">
                                <h3 class="api-title">Check Processing Status</h3>
                                <div class="method-badge method-get">GET</div>
                            </div>
                            <div class="api-path">/api/v1/monthly-statements/status/{session_id}</div>
                            <p class="api-description">
                                Check the processing status of your statement analysis session
                            </p>
                            
                            <div class="form-section">
                                <div class="form-group">
                                    <label for="sessionIdInput" class="form-label">Session ID</label>
                                    <input 
                                        type="text" 
                                        id="sessionIdInput" 
                                        class="form-input"
                                        placeholder="Enter session ID from processing request"
                                    >
                                </div>
                                <div class="form-actions">
                                    <button class="btn btn-success" data-endpoint="check-status">
                                        Check Status
                                    </button>
                                </div>
                            </div>
                            <div id="checkStatusResult" class="result-display"></div>
                        </div>
                    </div>
                </section>

                <!-- Invoices Section -->
                <section id="invoices" class="section">
                    <div class="section-header">
                        <h2 class="section-title">Invoice Processing</h2>
                        <p class="section-description">
                            Split multi-invoice PDFs into separate files for streamlined processing
                        </p>
                    </div>

                    <div class="grid">
                        <!-- Separate Invoices -->
                        <div class="api-card">
                            <div class="api-header">
                                <h3 class="api-title">Separate Invoices</h3>
                                <div class="method-badge method-post">POST</div>
                            </div>
                            <div class="api-path">/api/v1/invoices/separate</div>
                            <p class="api-description">
                                Split a single PDF containing multiple invoices into separate files
                            </p>
                            
                            <div class="form-section">
                                <div class="form-group">
                                    <label for="invoicePdfInput" class="form-label">Multi-Invoice PDF</label>
                                    <input 
                                        type="file" 
                                        id="invoicePdfInput" 
                                        class="form-file"
                                        accept=".pdf"
                                    >
                                </div>
                                <div class="form-actions">
                                    <button class="btn btn-success" data-endpoint="separate-invoices">
                                        Separate Invoices
                                    </button>
                                </div>
                            </div>
                            <div id="separateInvoicesResult" class="result-display"></div>
                        </div>
                    </div>
                </section>

                <!-- Macros Section -->
                <section id="macros" class="section">
                    <div class="section-header">
                        <h2 class="section-title">Excel Macros</h2>
                        <p class="section-description">
                            Generate professional VBA macro codes for Excel automation and data processing
                        </p>
                    </div>

                    <div class="grid">
                        <!-- Cleanup Macro -->
                        <div class="api-card">
                            <div class="api-header">
                                <h3 class="api-title">Data Cleanup Macro</h3>
                                <div class="method-badge method-get">GET</div>
                            </div>
                            <div class="api-path">/api/v1/excel-macros/cleanup</div>
                            <p class="api-description">
                                Generate VBA macro code for comprehensive data cleanup and formatting
                            </p>
                            
                            <div class="form-section">
                                <div class="form-actions">
                                    <button class="btn btn-success" data-endpoint="cleanup-macro">
                                        Generate Cleanup Macro
                                    </button>
                                </div>
                            </div>
                            <div id="cleanupMacroResult" class="result-display"></div>
                        </div>

                        <!-- Sort Macro -->
                        <div class="api-card">
                            <div class="api-header">
                                <h3 class="api-title">Sort & Sum Macro</h3>
                                <div class="method-badge method-get">GET</div>
                            </div>
                            <div class="api-path">/api/v1/excel-macros/sort</div>
                            <p class="api-description">
                                Generate VBA macro code for advanced sorting and automatic subtotal generation
                            </p>
                            
                            <div class="form-section">
                                <div class="form-actions">
                                    <button class="btn btn-success" data-endpoint="sort-macro">
                                        Generate Sort Macro
                                    </button>
                                </div>
                            </div>
                            <div id="sortMacroResult" class="result-display"></div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script src="/visualizer/script.js"></script>
</body>
</html>